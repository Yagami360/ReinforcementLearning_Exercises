# Deep Q Network（DQN）による倒立振子課題（CartPole）＜実装中＞
強化学習の学習環境用の倒立振子課題 CartPole。<br>
ディープラーニングを用いた強化学習手法であるDQN [Deep Q-Network] によって、単純な２次元の倒立振子課題を解く。<br>

## ■ 項目 [Contents]
1. [動作環境](#動作環境)
1. [使用法](#使用法)
1. [コード説明＆実行結果](#コード説明＆実行結果)
1. 背景理論
    1. [【外部リンク】強化学習 / Deep Q Network（DQN）](https://github.com/Yagami360/My_NoteBook/blob/master/%E6%83%85%E5%A0%B1%E5%B7%A5%E5%AD%A6/%E6%83%85%E5%A0%B1%E5%B7%A5%E5%AD%A6_%E6%A9%9F%E6%A2%B0%E5%AD%A6%E7%BF%92_%E5%BC%B7%E5%8C%96%E5%AD%A6%E7%BF%92.md#DeepQNetwork)


## ■ 動作環境

- Python : 3.6
- Anaconda : 5.0.1
- OpenAIGym : 0.10.9
- PyTorch : 1.0.0

## ■ 使用法

- 使用法
```
$ python main.py
```

- 設定可能な定数
```python
[main.py]
NUM_EPISODE = 200               # エピソード試行回数
NUM_TIME_STEP = 500             # １エピソードの時間ステップの最大数
BRAIN_LEARNING_RATE = 0.0001    # 学習率
BRAIN_BATCH_SIZE = 32           # ミニバッチサイズ
BRAIN_GREEDY_EPSILON = 0.5      # ε-greedy 法の ε 値
BRAIN_GAMMDA = 0.99             # 割引率
MEMORY_CAPACITY = 10000         # Experience Relay 用の学習用データセットのメモリの最大の長さ
```

<a id="コード説明＆実行結果"></a>

## ■ コード説明＆実行結果

### ◎ コードの実行結果


### ◎ コードの説明


## ■ デバッグ情報

```python
[main1_1.py]
outputs : tensor([[0.1276, 0.1241]])
index : tensor([0])
action : tensor([[0]])
```

```python
[main.py]
_state : tensor([ 0.0049, -0.0017,  0.0443, -0.0200])
outputs : tensor([-0.0438,  0.0833])
RuntimeError: Dimension out of range (expected to be in range of [-1, 0], but got 1)
```

```python
outputs : tensor([[-0.1144, -0.1509],
        [-0.1376, -0.2161],
        [-0.0978, -0.1020],
        [-0.0994, -0.1248],
        [-0.1301, -0.1704],
        [-0.1173, -0.1525],
        [-0.1179, -0.1636],
        [-0.1282, -0.1746],
        [-0.1136, -0.1562],
        [-0.1024, -0.1365],
        [-0.1015, -0.1218],
        [-0.1317, -0.1977],
        [-0.1195, -0.1719],
        [-0.0871, -0.1056],
        [-0.0948, -0.1041],
        [-0.0980, -0.1073],
        [-0.1036, -0.1444],
        [-0.1172, -0.1572],
        [-0.1020, -0.1307],
        [-0.1405, -0.2244],
        [-0.0870, -0.0999],
        [-0.1121, -0.1621],
        [-0.1290, -0.1814],
        [-0.1333, -0.1738],
        [-0.1447, -0.1969],
        [-0.0866, -0.0988],
        [-0.1194, -0.1498],
        [-0.1116, -0.1542],
        [-0.1299, -0.1765],
        [-0.1052, -0.1253],
        [-0.1157, -0.1463],
        [-0.1292, -0.1903]], grad_fn=<AddmmBackward>)
_q_function : tensor([[-0.1144],
        [-0.1376],
        [-0.0978],
        [-0.0994],
        [-0.1301],
        [-0.1525],
        [-0.1636],
        [-0.1746],
        [-0.1136],
        [-0.1024],
        [-0.1015],
        [-0.1317],
        [-0.1195],
        [-0.0871],
        [-0.0948],
        [-0.0980],
        [-0.1036],
        [-0.1572],
        [-0.1020],
        [-0.1405],
        [-0.0870],
        [-0.1121],
        [-0.1814],
        [-0.1738],
        [-0.1969],
        [-0.0866],
        [-0.1194],
        [-0.1116],
        [-0.1765],
        [-0.1052],
        [-0.1157],
        [-0.1292]], grad_fn=<GatherBackward>)

non_final_mask : tensor([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
        1, 1, 1, 1, 1, 1, 1, 1], dtype=torch.uint8)
next_outputs : tensor([[-0.1078, -0.1911],
        [-0.2476, -0.1774],
        [-0.2391, -0.1796],
        [-0.1586, -0.1662],
        [-0.2141, -0.1738],
        [-0.1946, -0.1815],
        [-0.0886, -0.2109],
        [-0.1712, -0.1807],
        [-0.2170, -0.1750],
        [-0.2037, -0.1813],
        [-0.1411, -0.1857],
        [-0.1511, -0.1711],
        [-0.1612, -0.1830],
        [-0.1384, -0.1878],
        [-0.2038, -0.1765],
        [-0.1962, -0.1815],
        [-0.2123, -0.1780],
        [-0.1147, -0.1885],
        [-0.1648, -0.1844],
        [-0.1338, -0.1868],
        [-0.1780, -0.1710],
        [-0.1685, -0.1834],
        [-0.1906, -0.1700],
        [-0.1644, -0.1804],
        [-0.2039, -0.1786],
        [-0.1703, -0.1767],
        [-0.1528, -0.1712],
        [-0.1825, -0.1723],
        [-0.0883, -0.2009],
        [-0.1129, -0.1928],
        [-0.1933, -0.1863],
        [-0.1651, -0.1818]], grad_fn=<AddmmBackward>)
next_state_values : tensor([-0.1078, -0.1774, -0.1796, -0.1586, -0.1738, -0.1815, -0.0886, -0.1712,
        -0.1750, -0.1813, -0.1411, -0.1511, -0.1612, -0.1384, -0.1765, -0.1815,
        -0.1780, -0.1147, -0.1648, -0.1338, -0.1710, -0.1685, -0.1700, -0.1644,
        -0.1786, -0.1703, -0.1528, -0.1723, -0.0883, -0.1129, -0.1863, -0.1651])
```